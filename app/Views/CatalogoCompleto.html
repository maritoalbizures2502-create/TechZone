<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda Dinámica - Categorías</title>

    <!-- Enlace a Bootstrap Icons para los iconos de categoría -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    
    <style>
        /* PALETA DE COLORES:
            - Azul Oscuro: #23406e (Encabezado/Texto principal)
            - Azul Claro/Gris: #e3eaf2 (Fondo de página)
            - Azul medio: #4a6fa5 (Tarjetas de producto/Fondo de imagen)
            - Azul Llamativo: #007bff (Elemento seleccionado)
            - Azul Muy Claro: #e6f3ff (Fondo de botón seleccionado)
        */
        html, body {
            height: 100%; 
            font-family: Arial, sans-serif;
            margin: 0;
            background-color: #e3eaf2;
        }
        
        /* Estilos de la Cabecera */
        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: #23406e;
            padding: 16px 32px;
            color: #fff;
            box-shadow: 0 2px 8px rgba(35,64,110,0.08);
        }
        .search-box {
            display: flex;
            align-items: center;
            background: #fff;
            border-radius: 20px;
            padding: 5px 16px;
            width: 320px;
            color: #23406e;
        }
        .search-box input {
            border: none;
            outline: none;
            flex: 1;
            padding: 5px;
            font-size: 1rem;
            background: transparent;
            color: #23406e;
        }
        .search-box input::placeholder {
            color: #90caf9;
        }
        .profile-icon {
            width: 40px;
            height: 40px;
            background: #34588c;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 1.5rem;
            box-shadow: 0 1px 4px rgba(35,64,110,0.08);
        }

        /* Estilos del Contenedor Principal (Flexbox) */
        .container {
            display: flex;
            padding: 32px;
            gap: 32px;
            max-width: 1200px;
            margin: 0 auto;
            min-height: calc(100vh - 102px); 
            align-items: flex-start;
        }
        
        /* ESTILOS DE LA BARRA LATERAL (TARJETA FLOTANTE DE CATEGORÍAS) */
        .sidebar {
            width: 280px; 
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08); 
            flex-grow: 0;
            padding: 24px 0; 
        }
        .sidebar h2 {
            font-size: 1.5rem; 
            font-weight: bold;
            color: #23406e; 
            padding: 0 24px; 
            margin-bottom: 20px;
            margin-top: 0;
        }

        /* Estilos para los enlaces (a) de categoría */
        .sidebar a {
            display: flex; 
            align-items: center;
            justify-content: space-between;
            width: 100%; 
            padding: 12px 24px; 
            margin: 0; 
            border: none;
            background-color: transparent; 
            color: #23406e;
            cursor: pointer;
            text-align: left;
            font-size: 1rem;
            transition: background-color 0.2s, color 0.2s;
            text-decoration: none;
            box-sizing: border-box;
            font-weight: 500;
        }

        /* Contenedor interno para Icono y Texto (para alineación) */
        .category-content {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        /* Estilo para el icono */
        .category-content i {
            font-size: 1.25rem;
            color: #23406e; 
        }
        
        /* Estilo para la flecha de navegación (derecha) */
        .arrow-icon {
            color: #90caf9; 
            font-size: 1rem;
            transition: color 0.2s;
        }
        
        /* Efecto Hover: Fondo Gris/Claro */
        .sidebar a:hover {
            background-color: #f5f5f5; 
            color: #23406e;
        }

        /* === ESTADO SELECCIONADO (AZUL LLAMATIVO) === */
        .sidebar a.selected {
            background-color: #e6f3ff; /* Fondo azul muy claro */
            color: #23406e;
            font-weight: bold;
            
            /* Borde izquierdo AZUL (#007bff) */
            border-left: 5px solid #007bff; 
            padding-left: 19px; 
        }
        
        /* Icono y flecha de la categoría seleccionada en azul */
        .sidebar a.selected .category-content i,
        .sidebar a.selected .arrow-icon {
            color: #007bff; 
        }

        
        /* Estilos de productos */
        .products {
            display: flex;
            flex: 1;
            gap: 32px;
            flex-wrap: wrap;
            justify-content: flex-start; 
            align-items: flex-start;
            padding-left: 0;
        }
        .product-card {
            background: #4a6fa5; 
            border-radius: 16px;
            padding: 20px;
            width: 220px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(35,64,110,0.07);
            color: #fff;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .product-card:hover {
            box-shadow: 0 6px 18px rgba(35,64,110,0.25);
            transform: translateY(-4px); 
        }
        .product-card img {
            width: 210px;
            height: 170px;
            border-radius: 8px;
            margin-bottom: 12px;
            background: #e3eaf2; 
            object-fit: cover;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        .product-card p {
            margin: 10px 0 5px;
            font-size: 15px;
            color: #fff;
        }
        .product-card span,
        .product-card .price {
            font-weight: bold;
            color: #e3f2fd; 
            font-size: 1.1rem;
        }

        /* Media Queries para responsividad */
        @media (max-width: 900px) {
            .container {
                flex-direction: column;
                gap: 16px;
                padding: 16px;
                min-height: auto; 
            }
            .sidebar {
                width: 100%;
                margin-bottom: 16px;
                padding: 18px; 
                height: auto; 
                flex-grow: 0;
            }
            .products {
                gap: 16px;
                justify-content: center; 
            }
            .product-card {
                width: 100%;
                max-width: 320px;
            }
            .product-card img {
                width: 100%;
                height: 160px;
                max-width: none;
            }
        }

        .btn-cart {
            margin-top: 10px;
            background: #007bff;
            color: #fff;
            border: none;
            border-radius: 8px;
            padding: 8px 16px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.2s;
            width: 100%;
        }
        .btn-cart:hover {
            background: #23406e;
        }
        .stock-text {
            margin-top: 8px;
            font-size: 0.98rem;
            color: #e3f2fd;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <header>
        <div style="display:flex; align-items:center; gap:15px;">
            <!-- BOTÓN DE REGRESO: Redirige a cliente.html -->
            <button onclick="window.location.href='cliente.html';" 
                    style="background:none; border:none; font-size:24px; color:#fff; cursor:pointer;">
                <i class="bi bi-arrow-left"></i>
            </button>
            <div class="search-box">
                <input type="text" id="search-input" placeholder="Buscar Productos">
                <i class="bi bi-search"></i>
            </div>
        </div>
        <div style="position: relative;">
  <button id="cart-btn" class="btn rounded-circle d-flex align-items-center justify-content-center"
    style="width: 40px; height: 40px; background-color: #fff; border: 3px solid #1976d2; box-sizing: border-box; border-radius: 50%;">
        <img src="C:\xampp\htdocs\img\3144456.png" alt="Carrito" style="width: 24px; height: 25px;">
  </button>
  <div id="cart-dropdown" style="display:none; position:absolute; right:0; top:50px; background:#fff; border-radius:50px; box-shadow:0 2px 8px rgba(0,0,0,0.15); min-width:240px; z-index:1000; padding:16px;">
    <h4 style="margin:0 0 8px 0; font-size:1rem; color:#23406e;">Carrito</h4>
    <ul id="cart-list" style="list-style:none; padding:0; margin:0; color:#23406e;"></ul>
    <div id="cart-empty" style="color:#888; font-size:0.95rem;">El carrito está vacío.</div>
  </div>
</div>
</div>
</div>
</nav>
        </div>
    </header>
    
    <div class="container">
        <div class="sidebar" id="sidebar">
            <h2>Categorías</h2>
            
            <!-- ENLACES DE NAVEGACIÓN con categorías originales -->
            <a href="#" class="category-link selected" data-category="Smart Watch">
                <span class="category-content">
                    <i class="bi bi-watch"></i>
                    Smart Watch
                </span>
                <i class="bi bi-chevron-right arrow-icon"></i>
            </a>
            <a href="#" class="category-link" data-category="Laptops">
                <span class="category-content">
                    <i class="bi bi-laptop"></i>
                    Laptops
                </span>
                <i class="bi bi-chevron-right arrow-icon"></i>
            </a>
            <a href="#" class="category-link" data-category="Teléfonos">
                <span class="category-content">
                    <i class="bi bi-phone"></i>
                    Teléfonos
                </span>
                <i class="bi bi-chevron-right arrow-icon"></i>
            </a>
            <a href="#" class="category-link" data-category="TVs">
                <span class="category-content">
                    <i class="bi bi-tv"></i>
                    TVs
                </span>
                <i class="bi bi-chevron-right arrow-icon"></i>
            </a>
            <a href="#" class="category-link" data-category="Bocinas">
                <span class="category-content">
                    <i class="bi bi-speaker"></i>
                    Bocinas
                </span>
                <i class="bi bi-chevron-right arrow-icon"></i>
            </a>
            <a href="#" class="category-link" data-category="Auriculares/Audífonos">
                <span class="category-content">
                    <i class="bi bi-headset"></i>
                    Auriculares/Audífonos
                </span>
                <i class="bi bi-chevron-right arrow-icon"></i>
            </a>
            <a href="#" class="category-link" data-category="Tablets">
                <span class="category-content">
                    <i class="bi bi-tablet"></i>
                    Tablets
                </span>
                <i class="bi bi-chevron-right arrow-icon"></i>
            </a>
            
        </div>
    
        <!-- Contenedor vacío donde JS insertará los productos -->
        <div class="products" id="products-container">
            <!-- Contenido cargado por JavaScript -->
        </div>
    </div>

    <script>
        // === BASE DE DATOS DE PRODUCTOS ===
        // NOTA IMPORTANTE: Todas las rutas de imagen deben ser RELATIVAS (ej: "img/archivo.webp").
        // Asegúrate de que los archivos estén en la carpeta 'img/' de tu XAMPP (htdocs/img/).
        const allCategories = {
            "Smart Watch": { 
                placeholder: "Buscar Smart Watches",
                items: [
                    { 
                        name: "Smartwatch Deportivo X-Pro", 
                        price: "Q1,599.00", 
                        imageUrl: "img/smartwatch1.webp",
                        stock: 27
                    },
                    { 
                        name: "Xiaomi Mi Watch Lite", 
                        price: "Q850.00", 
                        imageUrl: "img/watch2.webp",
                        stock: 15
                    },
                    { 
                        name: "Apple Watch SE (2nd Gen)", 
                        price: "Q3,999.00", 
                        imageUrl: "img/swatch3.jpg",
                        stock: 8
                    }
                ]
            },
            "Laptops": {
                placeholder: "Buscar Laptops",
                items: [
                    { 
                        name: "Laptop Ultrabook Core i5", 
                        price: "Q6,500.00", 
                        imageUrl: "C:/xampp/htdocs/img/hero_static__c9sislzzicq6_large.png",
                        stock: 10
                    },
                    { 
                        name: "MacBook Air M2", 
                        price: "Q11,999.00", 
                        imageUrl: "C:/xampp/htdocs/img/laptop3.webp",
                        stock: 5
                    },
                    { 
                        name: "Chromebook 14 Pulgadas", 
                        price: "Q2,800.00", 
                        imageUrl: "C:/xampp/htdocs/img/laptop2.jpg",
                        stock: 33
                    }
                ]
            },
            "Teléfonos": { 
                placeholder: "Buscar Teléfonos",
                items: [
                    { 
                        name: "Samsung Galaxy S24 Ultra", 
                        price: "Q14,000.00", 
                        imageUrl: "img/phone1.webp",
                        stock: 3
                    },
                    { 
                        name: "Samsung Galaxy A33 5G", 
                        price: "Q11,200.00", 
                        imageUrl: "img/phone2.webp",
                        stock: 7
                    },
                    {
                        name: "iPhone 15 Pro Max", 
                        price: "Q17,500.00", 
                        imageUrl: "C:/xampp/htdocs/img/iphone15promax.png",
                        stock: 2
                    },
                    { 
                        name: "iPhone 14 Pro Max", 
                        price: "Q7,900.00", 
                        imageUrl: "C:/xampp/htdocs/img/phone3.avif",
                        stock: 4
                    },
                ]
            },
            "TVs": {
                placeholder: "Buscar TVs",
                items: [
                    { 
                        name: "Smart TV 55\" 4K UHD", 
                        price: "Q4,199.00", 
                        imageUrl: "C:/xampp/htdocs/img/tv1.webp",
                        stock: 6
                    },
                    { 
                        name: "OLED TV 65\" 120Hz", 
                        price: "Q18,500.00", 
                        imageUrl: "C:/xampp/htdocs/img/tv2.webp",
                        stock: 1
                    },
                    { 
                        name: "TV Portátil 24\" HD", 
                        price: "Q1,500.00", 
                        imageUrl: "C:/xampp/htdocs/img/tv3.jpg",
                        stock: 14
                    }
                ]
            },
            "Bocinas": {
                placeholder: "Buscar Bocinas",
                items: [
                    { 
                        name: "Bocina Bluetooth JBL Flip 6", 
                        price: "Q1,199.00", 
                        imageUrl: "C:/xampp/htdocs/img/bocina1.avif",
                        stock: 20
                    },
                    { 
                        name: "Sistema de Sonido 2.1 con Subwoofer", 
                        price: "Q1,850.00", 
                        imageUrl: "C:/xampp/htdocs/img/bocina2.jpg",
                        stock: 5
                    },
                    { 
                        name: "Altavoz Inteligente Google Home", 
                        price: "Q650.00", 
                        imageUrl: "C:/xampp/htdocs/img/bocina3.jpg",
                        stock: 24
                    }
                ]
            },
            "Auriculares/Audífonos": {
                placeholder: "Buscar Audífonos",
                items: [
                    { 
                        name: "AirPods Pro (2nd Gen)", 
                        price: "Q2,499.00", 
                        imageUrl: "C:/xampp/htdocs/img/auri2.webp",
                        stock: 8
                    },
                    { 
                        name: "Audífonos Inalámbricos Sony WH-1000XM5", 
                        price: "Q3,799.00", 
                        imageUrl: "C:/xampp/htdocs/img/auri1.jpg",
                        stock: 4
                    },
                    { 
                        name: "Auriculares Gamer con Micrófono", 
                        price: "Q750.00", 
                        imageUrl: "C:/xampp/htdocs/img/auri3.webp",
                        stock: 15
                    }
                ]
            },
            "Tablets": {
                placeholder: "Buscar Tablets",
                items: [
                    { 
                        name: "iPad Air (5th Gen)", 
                        price: "Q8,999.00", 
                        imageUrl: "C:/xampp/htdocs/img/tab1.webp",
                        stock: 10
                    },
                    { 
                        name: "Samsung Galaxy Tab S9", 
                        price: "Q10,500.00", 
                        imageUrl: "C:/xampp/htdocs/img/tab3.jpg",
                        stock: 5
                    },
                    { 
                        name: "Tablet Amazon Fire 10", 
                        price: "Q1,599.00", 
                        imageUrl: "C:/xampp/htdocs/img/tab2.jpg",
                        stock: 15
                    }
                ]
            }
        };

        const productsContainer = document.getElementById('products-container');
        const searchInput = document.getElementById('search-input');
        const sidebarLinks = document.querySelectorAll('.category-link');
        
        // La categoría por defecto para iniciar ahora es 'Smart Watch'
        const defaultCategory = 'Smart Watch'; 

        // 1. FUNCIÓN: Genera el HTML de una tarjeta de producto
        function createProductCard(product, categoryIndex, productIndex) {
            const imageUrl = product.imageUrl;
            return `
                <div class="product-card" data-category-index="${categoryIndex}" data-product-index="${productIndex}">
                    <!-- Si la imagen no carga, se usa un placeholder con texto -->
                    <img src="${imageUrl}" alt="${product.name}" 
                         onerror="this.onerror=null;this.src='https://placehold.co/210x170/4a6fa5/ffffff?text=${encodeURIComponent(product.name)}';">
                    <p>${product.name}</p>
                    <span class="price">${product.price}</span>
                    <button class="btn-cart" onclick="addToCart('${categoryIndex}', ${productIndex})">Agregar al carrito</button>
                    <div class="stock-text" id="stock-${categoryIndex}-${productIndex}">Cantidad disponible: ${product.stock}</div>
                </div>
            `;
        }

        // 2. FUNCIÓN: Carga los productos de una categoría y actualiza el diseño
        function loadCategory(categoryName) {
            const categoryData = allCategories[categoryName];
            if (!categoryData) {
                productsContainer.innerHTML = '<h2>Error: Categoría no definida.</h2>';
                searchInput.placeholder = 'Buscar Productos';
                return;
            }
            // Generar el HTML de los productos
            productsContainer.innerHTML = categoryData.items
                .map((product, idx) => createProductCard(product, categoryName, idx))
                .join('');
            
            // Actualizar placeholder de búsqueda
            searchInput.placeholder = categoryData.placeholder;

            // Actualizar estilo 'selected' de la barra lateral
            sidebarLinks.forEach(link => {
                link.classList.remove('selected');
            });
            // Añade la clase 'selected' al enlace que coincida con la categoría cargada
            const selectedLink = document.querySelector(`.category-link[data-category="${categoryName}"]`);
            if (selectedLink) {
                selectedLink.classList.add('selected');
            }
        }

        // 3. EVENT LISTENERS: Escuchar clics en la barra lateral
        sidebarLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault(); // Evitar navegación
                const targetLink = e.target.closest('a.category-link');
                if (targetLink) {
                    const category = targetLink.dataset.category;
                    loadCategory(category);
                }
            });
        });

        // 4. INICIALIZACIÓN: Cargar la categoría por defecto inmediatamente al inicio del script.
        loadCategory(defaultCategory);

        // Guarda el stock original para poder reiniciar
const originalStock = {};
Object.keys(allCategories).forEach(cat => {
    allCategories[cat].items.forEach((prod, idx) => {
        if (!originalStock[cat]) originalStock[cat] = {};
        originalStock[cat][idx] = prod.stock;
    });
});

const cart = [];

// Modifica la función para crear la tarjeta de producto
function createProductCard(product, categoryName, productIndex) {
    const imageUrl = product.imageUrl.startsWith("C:/") ? "../../img/" + imageUrl.split("/").pop() : product.imageUrl;
    return `
        <div class="product-card">
            <img src="${imageUrl}" alt="${product.name}" 
                 onerror="this.onerror=null;this.src='https://placehold.co/210x170/4a6fa5/ffffff?text=${encodeURIComponent(product.name)}';">
            <p>${product.name}</p>
            <span class="price">${product.price}</span>
            <button class="btn-cart" onclick="addToCart('${categoryName}', ${productIndex})">Agregar al carrito</button>
            <div class="stock-text" id="stock-${categoryName}-${productIndex}">Cantidad disponible: ${product.stock}</div>
        </div>
    `;
}

// Función para agregar al carrito y actualizar stock
function addToCart(categoryName, productIndex) {
    const product = allCategories[categoryName].items[productIndex];
    if (product.stock > 0) {
        product.stock--;
        document.getElementById(`stock-${categoryName}-${productIndex}`).textContent =
            `Cantidad disponible: ${product.stock}`;
        cart.push({ name: product.name, price: product.price, category: categoryName, index: productIndex });
        updateCartDropdown();
    }
}

// Actualiza el contenido del carrito desplegable
function updateCartDropdown() {
    const cartList = document.getElementById('cart-list');
    const cartEmpty = document.getElementById('cart-empty');
    cartList.innerHTML = '';
    if (cart.length === 0) {
        cartEmpty.style.display = 'block';
    } else {
        cartEmpty.style.display = 'none';
        cart.forEach((item, i) => {
            const li = document.createElement('li');
            li.style.display = "flex";
            li.style.alignItems = "center";
            li.style.justifyContent = "space-between";
            li.style.marginBottom = "8px";
            li.innerHTML = `
                <span>${item.name} - ${item.price}</span>
                <button onclick="removeFromCart(${i})" style="background:#e53935; border:none; border-radius:8px; padding:4px 8px; margin-left:10px; cursor:pointer;">
                    <img src="C:/xampp/htdocs/img/1017530.png" alt="Eliminar" style="width:18px; height:18px;">
                </button>
            `;
            cartList.appendChild(li);
        });
    }
}

// Elimina producto del carrito y reinicia el stock
function removeFromCart(cartIndex) {
    const item = cart[cartIndex];
    if (item) {
        // Reinicia el stock en la base de datos y en la vista
        allCategories[item.category].items[item.index].stock = originalStock[item.category][item.index];
        document.getElementById(`stock-${item.category}-${item.index}`).textContent =
            `Cantidad disponible: ${originalStock[item.category][item.index]}`;
        cart.splice(cartIndex, 1);
        updateCartDropdown();
    }
}

// Mostrar/ocultar el carrito al hacer clic en el botón
document.getElementById('cart-btn').addEventListener('click', function(e) {
    e.stopPropagation();
    const dropdown = document.getElementById('cart-dropdown');
    dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
});

// Cierra el carrito si se hace clic fuera, excepto si el clic es en el botón de eliminar
document.addEventListener('click', function(e) {
    const cartBtn = document.getElementById('cart-btn');
    const cartDropdown = document.getElementById('cart-dropdown');
    // Si el clic es en el botón de eliminar o su imagen, no cerrar el carrito
    if (
        cartBtn.contains(e.target) ||
        cartDropdown.contains(e.target) ||
        (e.target.closest('button') && e.target.closest('button').onclick && e.target.closest('button').onclick.toString().includes('removeFromCart'))
    ) {
        return;
    }
    cartDropdown.style.display = 'none';
});
    </script>
</body>
</html>
